<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Map Operation for Batch Systems — batchMap • batchtools</title><!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.10/font.css" rel="stylesheet"><link href="../deps/JetBrains_Mono-0.4.10/font.css" rel="stylesheet"><link href="../deps/Roboto_Slab-0.4.10/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Map Operation for Batch Systems — batchMap"><meta name="description" content="A parallel and asynchronous Map/mapply for batch systems.
Note that this function only defines the computational jobs.
The actual computation is started with submitJobs.
Results and partial results can be collected with reduceResultsList, reduceResults or
loadResult.
For a synchronous Map-like execution, see btmapply."><meta property="og:description" content="A parallel and asynchronous Map/mapply for batch systems.
Note that this function only defines the computational jobs.
The actual computation is started with submitJobs.
Results and partial results can be collected with reduceResultsList, reduceResults or
loadResult.
For a synchronous Map-like execution, see btmapply."><meta name="robots" content="noindex"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">batchtools</a>

    <small class="nav-text text-default me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">0.9.17-9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html"><span class="fa fa-file-alt"></span> Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://mlr3book.mlr-org.com"><span class="fa fa-link"></span> mlr3book</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/mlr-org/batchtools/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://lmmisld-lmu-stats-slds.srv.mwn.de/mlr_invite/"><span class="fa fa-comments"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://stackoverflow.com/questions/tagged/mlr3"><span class="fa fab fa-stack-overflow"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://mlr-org.com/"><span class="fa fa-rss"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Map Operation for Batch Systems</h1>
      <small class="dont-index">Source: <a href="https://github.com/mlr-org/batchtools/blob/main/R/batchMap.R" class="external-link"><code>R/batchMap.R</code></a></small>
      <div class="d-none name"><code>batchMap.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>A parallel and asynchronous <code><a href="https://rdrr.io/r/base/funprog.html" class="external-link">Map</a></code>/<code><a href="https://rdrr.io/r/base/mapply.html" class="external-link">mapply</a></code> for batch systems.
Note that this function only defines the computational jobs.
The actual computation is started with <code><a href="submitJobs.html">submitJobs</a></code>.
Results and partial results can be collected with <code><a href="reduceResultsList.html">reduceResultsList</a></code>, <code><a href="reduceResults.html">reduceResults</a></code> or
<code><a href="loadResult.html">loadResult</a></code>.</p>
<p>For a synchronous <code><a href="https://rdrr.io/r/base/funprog.html" class="external-link">Map</a></code>-like execution, see <code><a href="btlapply.html">btmapply</a></code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">batchMap</span><span class="op">(</span></span>
<span>  <span class="va">fun</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  more.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  reg <span class="op">=</span> <span class="fu"><a href="getDefaultRegistry.html">getDefaultRegistry</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-fun">fun<a class="anchor" aria-label="anchor" href="#arg-fun"></a></dt>
<dd><p>[<code>function</code>]<br>
Function to map over arguments provided via <code>...</code>.
Parameters given via <code>args</code> or <code>...</code> are passed as-is, in the respective order and possibly named.
If the function has the named formal argument “.job”, the <code><a href="JobExperiment.html">Job</a></code> is passed to the function
on the slave.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>[ANY]<br>
Arguments to vectorize over (list or vector).
Shorter vectors will be recycled (possibly with a warning any length is not a multiple of the longest length).
Mutually exclusive with <code>args</code>.
Note that although it is possible to iterate over large objects (e.g., lists of data frames or matrices), this usually
hurts the overall performance and thus is discouraged.</p></dd>


<dt id="arg-args">args<a class="anchor" aria-label="anchor" href="#arg-args"></a></dt>
<dd><p>[<code>list</code> | <code>data.frame</code>]<br>
Arguments to vectorize over as (named) list or data frame.
Shorter vectors will be recycled (possibly with a warning any length is not a multiple of the longest length).
Mutually exclusive with <code>...</code>.</p></dd>


<dt id="arg-more-args">more.args<a class="anchor" aria-label="anchor" href="#arg-more-args"></a></dt>
<dd><p>[<code>list</code>]<br>
A list of further arguments passed to <code>fun</code>.
Default is an empty list.</p></dd>


<dt id="arg-reg">reg<a class="anchor" aria-label="anchor" href="#arg-reg"></a></dt>
<dd><p>[<code><a href="makeRegistry.html">Registry</a></code>]<br>
Registry. If not explicitly passed, uses the default registry (see <code><a href="getDefaultRegistry.html">setDefaultRegistry</a></code>).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>[<code><a href="https://rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></code>] with ids of added jobs stored in column “job.id”.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="batchReduce.html">batchReduce</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># example using "..." and more.args</span></span></span>
<span class="r-in"><span><span class="va">tmp</span> <span class="op">=</span> <span class="fu"><a href="makeRegistry.html">makeRegistry</a></span><span class="op">(</span>file.dir <span class="op">=</span> <span class="cn">NA</span>, make.default <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> No readable configuration file found</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Created registry in '/tmp/batchtools-example/reg1' using cluster functions 'Interactive'</span>
<span class="r-in"><span><span class="va">f</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span> <span class="va">x</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="va">y</span></span></span>
<span class="r-in"><span><span class="va">ids</span> <span class="op">=</span> <span class="fu">batchMap</span><span class="op">(</span><span class="va">f</span>, x <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, more.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>, reg <span class="op">=</span> <span class="va">tmp</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Adding 10 jobs ...</span>
<span class="r-in"><span><span class="fu"><a href="getJobTable.html">getJobPars</a></span><span class="op">(</span>reg <span class="op">=</span> <span class="va">tmp</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Key: &lt;job.id&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     job.id  job.pars</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      &lt;int&gt;    &lt;list&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1:      1 &lt;list[1]&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2:      2 &lt;list[1]&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3:      3 &lt;list[1]&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  4:      4 &lt;list[1]&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  5:      5 &lt;list[1]&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  6:      6 &lt;list[1]&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  7:      7 &lt;list[1]&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  8:      8 &lt;list[1]&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  9:      9 &lt;list[1]&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10:     10 &lt;list[1]&gt;</span>
<span class="r-in"><span><span class="fu"><a href="testJob.html">testJob</a></span><span class="op">(</span><span class="fl">6</span>, reg <span class="op">=</span> <span class="va">tmp</span><span class="op">)</span> <span class="co"># 100 + 6^2 = 136</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ### [bt]: Setting seed to 12787 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 136</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># vector recycling</span></span></span>
<span class="r-in"><span><span class="va">tmp</span> <span class="op">=</span> <span class="fu"><a href="makeRegistry.html">makeRegistry</a></span><span class="op">(</span>file.dir <span class="op">=</span> <span class="cn">NA</span>, make.default <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> No readable configuration file found</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Created registry in '/tmp/batchtools-example/reg2' using cluster functions 'Interactive'</span>
<span class="r-in"><span><span class="va">f</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">...</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">...</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ids</span> <span class="op">=</span> <span class="fu">batchMap</span><span class="op">(</span><span class="va">f</span>, x <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, y <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">6</span>, reg <span class="op">=</span> <span class="va">tmp</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Adding 6 jobs ...</span>
<span class="r-in"><span><span class="fu"><a href="getJobTable.html">getJobPars</a></span><span class="op">(</span>reg <span class="op">=</span> <span class="va">tmp</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Key: &lt;job.id&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    job.id  job.pars</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     &lt;int&gt;    &lt;list&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1:      1 &lt;list[2]&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2:      2 &lt;list[2]&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3:      3 &lt;list[2]&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4:      4 &lt;list[2]&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5:      5 &lt;list[2]&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6:      6 &lt;list[2]&gt;</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># example for an expand.grid()-like operation on parameters</span></span></span>
<span class="r-in"><span><span class="va">tmp</span> <span class="op">=</span> <span class="fu"><a href="makeRegistry.html">makeRegistry</a></span><span class="op">(</span>file.dir <span class="op">=</span> <span class="cn">NA</span>, make.default <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> No readable configuration file found</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Created registry in '/tmp/batchtools-example/reg3' using cluster functions 'Interactive'</span>
<span class="r-in"><span><span class="va">ids</span> <span class="op">=</span> <span class="fu">batchMap</span><span class="op">(</span><span class="va">paste</span>, args <span class="op">=</span> <span class="fu">data.table</span><span class="fu">::</span><span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/J.html" class="external-link">CJ</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>, y <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span>, reg <span class="op">=</span> <span class="va">tmp</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Adding 9 jobs ...</span>
<span class="r-in"><span><span class="fu"><a href="getJobTable.html">getJobPars</a></span><span class="op">(</span>reg <span class="op">=</span> <span class="va">tmp</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Key: &lt;job.id&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    job.id  job.pars</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     &lt;int&gt;    &lt;list&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1:      1 &lt;list[2]&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2:      2 &lt;list[2]&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3:      3 &lt;list[2]&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4:      4 &lt;list[2]&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5:      5 &lt;list[2]&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6:      6 &lt;list[2]&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7:      7 &lt;list[2]&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8:      8 &lt;list[2]&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9:      9 &lt;list[2]&gt;</span>
<span class="r-in"><span><span class="fu"><a href="testJob.html">testJob</a></span><span class="op">(</span><span class="fl">6</span>, reg <span class="op">=</span> <span class="va">tmp</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ### [bt]: Setting seed to 8571 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "b 3"</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Michel Lang, Bernd Bischl.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer></div>





  </body></html>

