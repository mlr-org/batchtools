<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Map Operation for Batch Systems — batchMap • batchtools</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Map Operation for Batch Systems — batchMap" />
<meta property="og:description" content="A parallel and asynchronous Map/mapply for batch systems.
Note that this function only defines the computational jobs.
The actual computation is started with submitJobs.
Results and partial results can be collected with reduceResultsList, reduceResults or
loadResult.
For a synchronous Map-like execution, see btmapply." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">batchtools</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.9.14</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/batchtools.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/mllg/batchtools/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Map Operation for Batch Systems</h1>
    <small class="dont-index">Source: <a href='https://github.com/mllg/batchtools/blob/master/R/batchMap.R'><code>R/batchMap.R</code></a></small>
    <div class="hidden name"><code>batchMap.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>A parallel and asynchronous <code><a href='https://rdrr.io/r/base/funprog.html'>Map</a></code>/<code><a href='https://rdrr.io/r/base/mapply.html'>mapply</a></code> for batch systems.
Note that this function only defines the computational jobs.
The actual computation is started with <code><a href='submitJobs.html'>submitJobs</a></code>.
Results and partial results can be collected with <code><a href='reduceResultsList.html'>reduceResultsList</a></code>, <code><a href='reduceResults.html'>reduceResults</a></code> or
<code><a href='loadResult.html'>loadResult</a></code>.</p>
<p>For a synchronous <code><a href='https://rdrr.io/r/base/funprog.html'>Map</a></code>-like execution, see <code><a href='btlapply.html'>btmapply</a></code>.</p>
    </div>

    <pre class="usage"><span class='fu'>batchMap</span><span class='op'>(</span>
  <span class='va'>fun</span>,
  <span class='va'>...</span>,
  args <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span>,
  more.args <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span>,
  reg <span class='op'>=</span> <span class='fu'><a href='getDefaultRegistry.html'>getDefaultRegistry</a></span><span class='op'>(</span><span class='op'>)</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>fun</th>
      <td><p>[<code>function</code>]<br />
Function to map over arguments provided via <code>...</code>.
Parameters given via <code>args</code> or <code>...</code> are passed as-is, in the respective order and possibly named.
If the function has the named formal argument &#8220;.job&#8221;, the <code><a href='makeJob.html'>Job</a></code> is passed to the function
on the slave.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>[ANY]<br />
Arguments to vectorize over (list or vector).
Shorter vectors will be recycled (possibly with a warning any length is not a multiple of the longest length).
Mutually exclusive with <code>args</code>.
Note that although it is possible to iterate over large objects (e.g., lists of data frames or matrices), this usually
hurts the overall performance and thus is discouraged.</p></td>
    </tr>
    <tr>
      <th>args</th>
      <td><p>[<code>list</code> | <code>data.frame</code>]<br />
Arguments to vectorize over as (named) list or data frame.
Shorter vectors will be recycled (possibly with a warning any length is not a multiple of the longest length).
Mutually exclusive with <code>...</code>.</p></td>
    </tr>
    <tr>
      <th>more.args</th>
      <td><p>[<code>list</code>]<br />
A list of further arguments passed to <code>fun</code>.
Default is an empty list.</p></td>
    </tr>
    <tr>
      <th>reg</th>
      <td><p>[<code><a href='makeRegistry.html'>Registry</a></code>]<br />
Registry. If not explicitly passed, uses the default registry (see <code><a href='getDefaultRegistry.html'>setDefaultRegistry</a></code>).</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>[<code><a href='https://Rdatatable.gitlab.io/data.table/reference/data.table.html'>data.table</a></code>] with ids of added jobs stored in column &#8220;job.id&#8221;.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='batchReduce.html'>batchReduce</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'> <span class='fu'>batchtools</span><span class='fu'>:::</span><span class='fu'>example_push_temp</span><span class='op'>(</span><span class='fl'>3</span><span class='op'>)</span> 
<span class='co'># example using "..." and more.args</span>
<span class='va'>tmp</span> <span class='op'>=</span> <span class='fu'><a href='makeRegistry.html'>makeRegistry</a></span><span class='op'>(</span>file.dir <span class='op'>=</span> <span class='cn'>NA</span>, make.default <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>No readable configuration file found</span></div><div class='output co'>#&gt; <span class='message'>Created registry in '/tmp/batchtools-example/reg1' using cluster functions 'Interactive'</span></div><div class='input'><span class='va'>f</span> <span class='op'>=</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>y</span><span class='op'>)</span> <span class='va'>x</span><span class='op'>^</span><span class='fl'>2</span> <span class='op'>+</span> <span class='va'>y</span>
<span class='va'>ids</span> <span class='op'>=</span> <span class='fu'>batchMap</span><span class='op'>(</span><span class='va'>f</span>, x <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>10</span>, more.args <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>y <span class='op'>=</span> <span class='fl'>100</span><span class='op'>)</span>, reg <span class='op'>=</span> <span class='va'>tmp</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>Adding 10 jobs ...</span></div><div class='input'><span class='fu'><a href='getJobTable.html'>getJobPars</a></span><span class='op'>(</span>reg <span class='op'>=</span> <span class='va'>tmp</span><span class='op'>)</span>
</div><div class='output co'>#&gt;     job.id  job.pars
#&gt;  1:      1 &lt;list[1]&gt;
#&gt;  2:      2 &lt;list[1]&gt;
#&gt;  3:      3 &lt;list[1]&gt;
#&gt;  4:      4 &lt;list[1]&gt;
#&gt;  5:      5 &lt;list[1]&gt;
#&gt;  6:      6 &lt;list[1]&gt;
#&gt;  7:      7 &lt;list[1]&gt;
#&gt;  8:      8 &lt;list[1]&gt;
#&gt;  9:      9 &lt;list[1]&gt;
#&gt; 10:     10 &lt;list[1]&gt;</div><div class='input'><span class='fu'><a href='testJob.html'>testJob</a></span><span class='op'>(</span><span class='fl'>6</span>, reg <span class='op'>=</span> <span class='va'>tmp</span><span class='op'>)</span> <span class='co'># 100 + 6^2 = 136</span>
</div><div class='output co'>#&gt; ### [bt]: Setting seed to 12787 ...</div><div class='output co'>#&gt; [1] 136</div><div class='input'>
<span class='co'># vector recycling</span>
<span class='va'>tmp</span> <span class='op'>=</span> <span class='fu'><a href='makeRegistry.html'>makeRegistry</a></span><span class='op'>(</span>file.dir <span class='op'>=</span> <span class='cn'>NA</span>, make.default <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>No readable configuration file found</span></div><div class='output co'>#&gt; <span class='message'>Created registry in '/tmp/batchtools-example/reg2' using cluster functions 'Interactive'</span></div><div class='input'><span class='va'>f</span> <span class='op'>=</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>...</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='va'>...</span><span class='op'>)</span>
<span class='va'>ids</span> <span class='op'>=</span> <span class='fu'>batchMap</span><span class='op'>(</span><span class='va'>f</span>, x <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span>, y <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>6</span>, reg <span class='op'>=</span> <span class='va'>tmp</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>Adding 6 jobs ...</span></div><div class='input'><span class='fu'><a href='getJobTable.html'>getJobPars</a></span><span class='op'>(</span>reg <span class='op'>=</span> <span class='va'>tmp</span><span class='op'>)</span>
</div><div class='output co'>#&gt;    job.id  job.pars
#&gt; 1:      1 &lt;list[2]&gt;
#&gt; 2:      2 &lt;list[2]&gt;
#&gt; 3:      3 &lt;list[2]&gt;
#&gt; 4:      4 &lt;list[2]&gt;
#&gt; 5:      5 &lt;list[2]&gt;
#&gt; 6:      6 &lt;list[2]&gt;</div><div class='input'>
<span class='co'># example for an expand.grid()-like operation on parameters</span>
<span class='va'>tmp</span> <span class='op'>=</span> <span class='fu'><a href='makeRegistry.html'>makeRegistry</a></span><span class='op'>(</span>file.dir <span class='op'>=</span> <span class='cn'>NA</span>, make.default <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>No readable configuration file found</span></div><div class='output co'>#&gt; <span class='message'>Created registry in '/tmp/batchtools-example/reg3' using cluster functions 'Interactive'</span></div><div class='input'><span class='va'>ids</span> <span class='op'>=</span> <span class='fu'>batchMap</span><span class='op'>(</span><span class='va'>paste</span>, args <span class='op'>=</span> <span class='fu'>data.table</span><span class='fu'>::</span><span class='fu'><a href='https://Rdatatable.gitlab.io/data.table/reference/J.html'>CJ</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>letters</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span><span class='op'>]</span>, y <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span><span class='op'>)</span>, reg <span class='op'>=</span> <span class='va'>tmp</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>Adding 9 jobs ...</span></div><div class='input'><span class='fu'><a href='getJobTable.html'>getJobPars</a></span><span class='op'>(</span>reg <span class='op'>=</span> <span class='va'>tmp</span><span class='op'>)</span>
</div><div class='output co'>#&gt;    job.id  job.pars
#&gt; 1:      1 &lt;list[2]&gt;
#&gt; 2:      2 &lt;list[2]&gt;
#&gt; 3:      3 &lt;list[2]&gt;
#&gt; 4:      4 &lt;list[2]&gt;
#&gt; 5:      5 &lt;list[2]&gt;
#&gt; 6:      6 &lt;list[2]&gt;
#&gt; 7:      7 &lt;list[2]&gt;
#&gt; 8:      8 &lt;list[2]&gt;
#&gt; 9:      9 &lt;list[2]&gt;</div><div class='input'><span class='fu'><a href='testJob.html'>testJob</a></span><span class='op'>(</span><span class='fl'>6</span>, reg <span class='op'>=</span> <span class='va'>tmp</span><span class='op'>)</span>
</div><div class='output co'>#&gt; ### [bt]: Setting seed to 8571 ...</div><div class='output co'>#&gt; [1] "b 3"</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Michel Lang, Bernd Bischl.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


